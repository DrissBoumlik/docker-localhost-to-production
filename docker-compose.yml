version: '3'

services:
  simple-page:
    build: ./simple-page
    env_file: .env
    image: swoldanski/docker-l2p-simple-page:${VERSION:-0.1.8}
    deploy:
      replicas: 3
    ports:
      - 80:80
  
  ping-broker:
    build: ./ping-broker
    env_file: .env
    image: swoldanski/docker-l2p-ping-broker:${VERSION:-0.1.8}
    deploy:
      replicas: 2
    ports:
      - 8000:80
  
  rabbit-master:
    image: rabbitmq:3-management
    env_file: .env
    deploy:
      replicas: 1
    ports:
      - 8080:15672
  
  rabbit-backup:
    image: rabbitmq:3-management
    env_file: .env
    deploy:
      replicas: 1
    ports:
      - 8090:15672
    
# infra & monitoring

    